# Cryptographic API Misuse Vulnerability : Do not use non-random/static)predictable IVs in CBC



### Description:

In the PyPinkSign v0.5.1,it is a friendly Python library for NPKI.

It utilizes a non-random or static IV for Cipher Block Chaining (CBC) mode in AES encryption. Using default predictable IVs can lead to vulnerabilities like the disclosure of information about the plaintext of subsequent messages.   `IV=0123456789012345`

### Affected Version

[v0.5.1](https://github.com/bandoche/PyPinkSign/releases/tag/v0.5.1)

### Location:

https://github.com/bandoche/PyPinkSign/blob/main/pypinksign/pypinksign.py#L504
https://github.com/bandoche/PyPinkSign/blob/main/pypinksign/pypinksign.py#L537

### Reference

- CWE-329: Generation of Predictable IV with CBC Modeï¼›
- CWE-330: Use of Insufficiently Random Values

### Expected Behavior:

The IV for CBC mode should be random and unpredictable for each encryption operation to ensure the security of the encryption scheme.

### Actual Behavior:

A static IV is used across encryption operations, making the encrypted data less secure and potentially leading to patterns that can be exploited by attackers. Default-->  `IV=0123456789012345`

### Recommendation

Do not set default constant iv for CBC encryption. And modify the encryption process to generate a random IV each time an encryption operation is performed.



Addressing these issues is critical to maintaining the confidentiality and integrity of the data processed by PyPinkSign. It is recommended to take immediate action to correct these vulnerabilities and prevent potential exploits.



